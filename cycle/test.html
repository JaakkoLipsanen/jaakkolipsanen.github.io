<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		
		<title>flai</title>
		<meta name="description" content="The personal website of Jaakko Lipsanen">
		<meta name="author" content="Jaakko Lipsanen">		
		<meta name="keywords" content="gamedev, game, xna, unity, finland, developer, c#, c++, javascript, html5">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<meta charset="UTF-8">
		
		<link rel="stylesheet" type="text/css" href="../styles/general.css" />
		<link href='http://fonts.googleapis.com/css?family=Open+Sans%7CYanone+Kaffeesatz' rel='stylesheet' type='text/css' />
		
		
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
		<script type="text/javascript" src="https://maps.google.com/maps/api/js?libraries=geometry&sensor=true&region=ES"></script>
		
		<script type="text/javascript" src="../gallery/scripts/gallery.js"></script>
		<script type="text/javascript" src="scripts/cycleMap.js"></script>
		<script type="text/javascript" src="../scripts/helpers.js"></script>
		<script type="text/javascript" src="../scripts/inputState.js"></script>
		
		<script>
		 
			function initialize() {	

				/*
				 var map = new CycleMap(
					document.getElementById("map-div"), 
					new MapProperties(MapType.Terrain, LabelType.Hidden), 
					new Route(["data/europe14/cycle-sweden-norway.path", "data/europe14/cycle-denmark-belgium.path"], ["data/europe14/boat-finland-sweden.path", "data/europe14/boat-norway-denmark.path"]),
					new NightCollection("data/europe14/nights.gpx"));
						
				var gallery = new Gallery("Europe '14", document.getElementById("gallery"), "data/europe14/photos", "../gallery/");
					
				map.WhenLoaded(function() {
					document.getElementById("tripKm").innerHTML = map.RouteLength + "km";
					document.getElementById("tripNights").innerHTML = map.NightCount + " days";
				});
				
				$(".navigation-icon").hover(function(event) {
					$(event.target).siblings(".navigation-icon-text").css("opacity", "0.35");
				}, function(event) {
					$(event.target).siblings(".navigation-icon-text").css("opacity", "0.0");
				});
				
				*/
				
				var europe14 = new Route(["data/europe14/cycle-sweden-norway.path", "data/europe14/cycle-denmark-belgium.path"], ["data/europe14/boat-finland-sweden.path", "data/europe14/boat-norway-denmark.path"]);
				var spain14 = new Route([ "data/spain14/cycle-spain.path" ], [ ])

				var paintRoute = function(context, route) {
					var mapWidth = context.canvas.width;
					var mapHeight = context.canvas.height;
					var lonToX = function(longitude) {

						// hÃ¤x!! for some reason, longitude > 0 works pretty much perfectly, but with negative values it doesn't work properly (some values are correct, some are bit wrong)
						if(longitude > 0)
							return mapWidth / 2 + (longitude / 180 * (mapWidth / 2)) * 0.946;
						else {
							return mapWidth / 2 + (longitude / 187.480162 * (mapWidth / 2));
						}
					}
					
					var latToY = function(latitude) {
						var latRad = latitude * Math.PI / 180;
						var mercN = Math.log(Math.tan((Math.PI / 4) + (latRad / 2)));
						return mapHeight * 0.65131894484 - (mapWidth * mercN / (2*Math.PI)) * 0.935;
					}
					
					for(var i = 0; i < route.CyclingPaths.length; i++) {
						var startPoint = route.CyclingPaths[i].Points[0];
						context.moveTo(lonToX(startPoint.lng()), latToY(startPoint.lat()));
						
						for(var j = 1; j < route.CyclingPaths[i].Points.length; j += 25) {
							var point = route.CyclingPaths[i].Points[j];
							context.lineTo(lonToX(point.lng()), latToY(point.lat()));
						}
					}
					
					for(var i = 0; i < route.TransportPaths.length; i++) {
						var startPoint = route.TransportPaths[i].Points[0];
						context.moveTo(lonToX(startPoint.lng()), latToY(startPoint.lat()));
						
						for(var j = 1; j < route.TransportPaths[i].Points.length; j++) {
							var point = route.TransportPaths[i].Points[j];
							context.lineTo(lonToX(point.lng()), latToY(point.lat()));
						}
					}
				};
				
				var canvas = document.getElementById("route-canvas");
				var paintCanvas = function() {
					var context = canvas.getContext('2d');
					
					context.beginPath();
					paintRoute(context, europe14);
					paintRoute(context, spain14);

					context.lineWidth = 2;
					context.strokeStyle = 'rgb(96, 96, 96)'; // "rgb(172, 32, 32)";
					context.stroke();

				};		
				
				var updateCanvasSize = function() {
					canvas.width = $("#map-img").width();
					canvas.height = $("#map-img").height();
					
					paintCanvas();
				};
				
				$(window).resize(updateCanvasSize);
				updateCanvasSize();
				
				spain14.Load(function() {
					paintCanvas();
				});
				
				europe14.Load(function() {
					paintCanvas();
				});
			
				$("#route-selection-list li").click(function() {
					var clickedButton = $(this);
					if(clickedButton.hasClass('selected')) {
						return;
					}
					
					$("#route-selection-list li").removeClass('selected');
					clickedButton.addClass('selected');
				});
			}
			
			google.maps.event.addDomListener(window, 'load', initialize);
		</script>
		
		<!-- Style inlined -->
		<style>
			#content-div {
				text-align: center;
				display: block;
				margin: auto;
				
				width: auto; 
				height: auto;
				
				margin-top: 36px;
				margin-bottom: 36px;
			}

			#route-selection-list-container {
				display: table;
				width: 100%;
				margin-left: auto;
				margin-right: auto; }


			#route-selection-list {
				list-style-type: none; 
				text-align: center;
				margin: 0px;

				display: inline-block;
				
				width: 600px;
				max-width: 90%;
				
				height: 40px;
				padding: 3px 3px 7px; /* 3px == real padding. 7px == 3px + 4px. 4px because no fucking clue why it's needed on bottom */

				background-color: rgb(64, 64, 64);
				border-radius: 5px;
				
				white-space: nowrap;
			}
			
			#route-selection-list li {
				float: left;
				
				width: 33.33333%;
				height: auto;
				
				text-align: center;
				vertical-align: middle;
				display: table;
				
				background-color: rgb(24, 24, 24); /* the site background color */
				transition: background-color 0.3s ease-in-out;
			}
			
			#route-selection-list .selected {
				background-color: rgb(64, 64, 64);
			}
			
			#route-selection-list p {
				height: 100%;
				display: table-cell;
				vertical-align: middle;
				
				font-size: 1em; 
				font-family: Open Sans;
				color: rgb(128, 128, 128);
			}
			
			#route-selection-list span {
				color: rgb(88, 88, 88);
			}
				
		</style>
  </head>
	<body>
	
		<!-- Top Header -->
		<div style="background-color: rgb(24, 24, 24);" id="header-div" class="cycle-header" >
			
			<p id="header-text">flai</p>
			
			<!-- left side "code" icon -->
			<a href="/code"> 
				<p class="navigation-icon-text" style="right: auto; left: calc(8px + 48px + 8px)">code</p>
				<img class="navigation-icon" src="icons/CodeIcon.png" style="right: auto; left: calc(8px)" /> 
			</a>
			
		</div>
		
		
		
		<div id="content-div">  
		
			<!-- Map -->
			<div id="map-divider" style="max-width: 1600px; width: 90%; max-height: 70vh; position: relative; display: inline-block; margin: 0px; padding: 0px; text-align: center;">
				<img id="map-img" src="icons/WorldMapBlank.png" style="max-width:100%; max-height: 70vh; position: relative; left: 0px; top: 0px; margin: 0; padding: 0;" ></img>
				<canvas id="route-canvas" style="position: absolute; left: 0px; right: 0px; top: 0px; margin-left: auto;  margin-right: auto; padding: 0;" />
			</div>	

			<div id="route-selection-list-container" style="margin-top: 64px">
				<ul id="route-selection-list">
					<li>
						<p id="europe14-trip-button">North Europe <span style="display: block;">2014</span></p>
					</li>
					
					<li class="selected">
						<p>Spain <span style="display: block;">2014</span></p>
					</li>
					
					<li>
						<p>Central Europe <span style="display: block;">2015</span></p>
					</li>
				</ul>
			</div>	
		</div>
	
		
		<!-- Some space before footer -->
		<div style="height: 48px"></div>
		
		<!-- FOOTER -->
		<div>
			<hr />
			<p class="footer-text"><a href="mailto:jaakko.lipsanen@outlook.com">jaakko.lipsanen@outlook.com</a></p>
			<p class="footer-text">&copy; Jaakko Lipsanen. All Rights Reserved</p>
			<p class="footer-text" id="hosted-on-github-text">Hosted on <a href="https://pages.github.com/">GitHub Pages</a> </p>
		</div>
	</body>
</html>